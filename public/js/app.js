$(function(){function t(){for(var t=360/g.length*i,e=0;e<g.length;e++)n(0,0,h,e*t,(e+1)*t,m[e]),b.save(),a(v,0,0,e*t+.5*t,g[e]),b.restore()}function e(){b.beginPath(),b.fillStyle="#000000",b.moveTo(135,0),b.lineTo(u,12),b.lineTo(u,-12),b.closePath(),b.fill()}function n(t,e,n,a,l,r){b.beginPath(),b.moveTo(t,e),b.fillStyle=r,b.arc(t,e,n,a,l),b.fill(),b.closePath()}function a(t,e,n,a,l){b.fillStyle="#222222",b.rotate(a),b.textAlign="center",b.textBaseline="middle",b.font="14px 微軟正黑體",b.fillText(l,t,e)}function l(t){return t.map(function(t,e,n){return r(n.length,e)})}function r(t,e){return"hsl("+360*e/t+",100%,75%)"}var i=Math.PI/180,o=document.getElementById("canvas_Launch"),c=o.offsetWidth,f=c/2,s=o.offsetHeight,u=s/2,d=c<s?cavnas_width:s,h=d/2,v=h/2,b=o.getContext("2d");b.translate(f,u);var g=["東野日式料理","絕代雙驕","羊肉麵線","八方雲集","悟饕便當","肉圓","美而美早餐店","老五","雲吞/咖哩飯","丼飯","麥當勞","摩斯","該找找新的了..."],m=l(g);t(),e();var _=null,p=0;$("#btn_Start").click(function(){if($("#btn_Start").attr("disabled",!0),$("#btn_AddRestaurant").attr("disabled",!0),_)return!1;var n=30+1e3*Math.random();_=setInterval(function(){if(n<=.02){clearInterval(_),_=null,$("#btn_Start").attr("disabled",!1),$("#btn_AddRestaurant").attr("disabled",!1);var a=Math.floor((360-p)/(360/g.length));confirm("今天想吃 "+g[a]+" 嗎?")||(g.splice(a,1),m=l(g),b.save(),b.rotate(p*i),t(),b.restore(),e())}else p+=n,p>360&&(p-=360),b.clearRect(-f,-u,f,u),b.save(),b.rotate(p*i),t(),b.restore(),e();n*=.975},13)}),$("#btn_AddRestaurant").click(function(){var n=prompt("請輸入餐廳名稱","");null!=n&&(g.push(n),m=l(g),t(),e())})});