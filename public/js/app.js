$(function(){function t(){for(var t=360/m.length*i,e=0;e<m.length;e++)n(0,0,v,e*t,(e+1)*t,_[e]),g.save(),a(b,0,0,e*t+.5*t,m[e]),g.restore()}function e(){g.beginPath(),g.fillStyle="#000000",g.moveTo(135,0),g.lineTo(u,12),g.lineTo(u,-12),g.closePath(),g.fill()}function n(t,e,n,a,l,r){g.beginPath(),g.moveTo(t,e),g.fillStyle=r,g.arc(t,e,n,a,l),g.fill(),g.closePath()}function a(t,e,n,a,l){g.fillStyle="#222222",g.rotate(a),g.textAlign="center",g.textBaseline="middle",g.font="14px 微軟正黑體",g.fillText(l,t,e)}function l(t){return t.map(function(t,e,n){return r(n.length,e)})}function r(t,e){return"hsl("+360*e/t+",100%,75%)"}var i=Math.PI/180,o=document.getElementById("canvas_Launch"),c=o.offsetWidth,f=c/2,s=o.offsetHeight,u=s/2,d=c<s?cavnas_width:s,h=d/2,v=h-10,b=h/2,g=o.getContext("2d");g.translate(f,u);var m=["福州乾拌麵","麥當勞","燒臘","牛肉麵","漢堡王","蚵仔麵線","池上飯包","湯包大餛飩","自助餐","麵食館","三商巧福","鮮五丼","鬍鬚張","PizzaHut","該找找新的了..."],_=l(m);t(),e();var p=null,P=0;$("#btn_Start").click(function(){if($("#btn_Start").attr("disabled",!0),$("#btn_AddRestaurant").attr("disabled",!0),p)return!1;var n=30+1e3*Math.random();p=setInterval(function(){if(n<=.02){clearInterval(p),p=null,$("#btn_Start").attr("disabled",!1),$("#btn_AddRestaurant").attr("disabled",!1);var a=Math.floor((360-P)/(360/m.length));confirm("今天想吃 "+m[a]+" 嗎?")||(m.splice(a,1),_=l(m),g.save(),g.rotate(P*i),t(),g.restore(),e())}else P+=n,P>360&&(P-=360),g.clearRect(-f,-u,c,s),g.save(),g.rotate(P*i),t(),g.restore(),e();n*=.975},13)}),$("#btn_AddRestaurant").click(function(){var n=prompt("請輸入餐廳名稱","");null!=n&&(m.push(n),_=l(m),t(),e())})});